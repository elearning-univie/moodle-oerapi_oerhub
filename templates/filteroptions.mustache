{{!
  This file is part of Moodle - http://moodle.org/

  Moodle is free software: you can redistribute it and/or modify
  it under the terms of the GNU General Public License as published by
  the Free Software Foundation, either version 3 of the License, or
  (at your option) any later version.

  Moodle is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  GNU General Public License for more details.

  You should have received a copy of the GNU General Public License
  along with Moodle.  If not, see <http://www.gnu.org/licenses/>.
}}
{{!
    @template oerapi_oerhub/filteroptions

    Example context (json):
    {
    }
}}
{{#filterdata}}
<div class="filter-container mb-3">
    <h4>{{foundcount}} {{# str }} resourcesfound, oerapi_oerhub {{/ str }}</h4>
    <a class="icons-collapse-expand notextdecoration mb-3" data-toggle="collapse" href="#collapseOptions" aria-expanded="false" aria-controls="collapseOptions">
        {{#str}} filterresults, oerapi_oerhub {{/str}}
        <span class="collapsed-icon icon-no-margin mr-1" title="{{#str}} expand, core {{/str}}">
            <span class="dir-rtl-hide">{{#pix}} t/collapsedchevron, core {{/pix}}</span>
            <span class="dir-ltr-hide">{{#pix}} t/collapsedchevron_rtl, core {{/pix}}</span>
            <span class="sr-only">{{#str}} expand, core {{/str}}</span>
        </span>
        <span class="expanded-icon icon-no-margin mr-1" title="{{#str}} collapse, core {{/str}}">
            {{#pix}} t/expandedchevron, core {{/pix}}
            <span class="sr-only">{{#str}} collapse, core {{/str}}</span>
        </span>
    </a>
    <div class="collapse mb-4 {{#open}}show{{/open}}" id="collapseOptions">
        <div class="container">
            {{#filteroptions}}
            <div class="row mb-2">
                <div class="col col-md-2">
                    <label for="{{name}}">{{label}}</label>
                </div>
                <div class="col col-md-4">
                    <select class="filterdata w-100" id="{{name}}" name="{{name}}">
                        <option value=""></option>
                        {{#options}}
                            <option value="{{value}}" {{#selected}}selected{{/selected}}>{{optionlabel}}</option>
                        {{/options}}
                    </select>
                </div>
            </div>
            {{/filteroptions}}
            <div class="row mb-2">
                <div class="col col-md-2">
                    <label for="releasefromcheckbox">{{#str}} releasedfrom, oerapi_oerhub {{/str}}</label>
                </div>
                <div class="col">
                    <input type="checkbox" id="yearfromcheckbox" {{#yearfrom}}checked{{/yearfrom}}>

                    <select class="filterdata" id="yearfrom" {{^yearfrom}}disabled{{/yearfrom}}>
                        <!-- Options will be generated by JavaScript -->
                    </select>
                </div>
            </div>
            <div class="row mb-2">
                <div class="col col-md-2">
                    <label for="releasetocheckbox">{{#str}} releasedto, oerapi_oerhub {{/str}}</label>
                </div>
                <div class="col" id="yeartofilter">
                    <input type="checkbox" id="yeartocheckbox" {{#yearto}}checked{{/yearto}}>

                    <select class="filterdata" id="yearto" {{^yearto}}disabled{{/yearto}}>
                        <!-- Options will be generated by JavaScript -->
                    </select>
                </div>
            </div>
        </div>
    </div>
    <input type="submit" class="btn btn-secondary" value="{{#str}} resetfilter, oerapi_oerhub {{/str}}" name="reset">
    <button type="submit" class="btn btn-primary" id="submitfilter">{{#str}} filter, oerapi_oerhub {{/str}}</button>
    <input type="hidden" name="filterdata" id="filterdata">
</div>
{{/filterdata}}

{{#js}}
    populateDropdown = (dropdownname, filteredyear) => {
        const dropdown = document.getElementById(dropdownname);
        const currentYear = new Date().getFullYear();
        for (let i = 0; i < 10; i++) {
            const year = currentYear - i;
            const option = document.createElement('option');
            option.value = year;
            option.textContent = year;
            if (filteredyear && filteredyear == year) {
                option.selected = true;
            }
            dropdown.appendChild(option);
        }
    }
    window.onload = populateDropdown('yearfrom', {{filterdata.yearfrom}});
    window.onload = populateDropdown('yearto', {{filterdata.yearto}});
{{/js}}
{"version":3,"file":"filterutil.min.js","sources":["../src/filterutil.js"],"sourcesContent":["import {getString} from 'core/str';\n\nconst readFilter = () => {\n    const selectedValues = Array.from(document.querySelectorAll('select.filterdata'))\n        .reduce((values, select) => {\n            const id = select.id;\n            const selectedValue = select.value;\n\n            // Skip adding if the related checkbox is unchecked\n            if ((id === 'yearfrom' || id === 'yearto') && !document.getElementById(`${id}checkbox`).checked) {\n                return values;\n            }\n\n            values[id] = selectedValue;\n            return values;\n        }, {});\n\n    // If both year values are present, perform date validation.\n    if (selectedValues.yearfrom && selectedValues.yearto) {\n        if (selectedValues.yearfrom > selectedValues.yearto) {\n            const errorDiv = document.getElementById('yeartofilter');\n            if (errorDiv) {\n                if (!errorDiv.querySelector('.date-error')) {\n                    const errorMsg = document.createElement('p');\n                    errorMsg.classList.add('date-error');\n                    getString('dateerror', 'oerapi_oerhub').then((infomessage) => {\n                        errorMsg.textContent = infomessage;\n                        errorDiv.appendChild(errorMsg);\n                    });\n                }\n            }\n            return false;\n        }\n    }\n\n    // If validation passes, clear any existing error message.\n    const errorDiv = document.getElementById('yeartofilter');\n    if (errorDiv) {\n        const existingError = errorDiv.querySelector('.date-error');\n        if (existingError) {\n            existingError.remove();\n        }\n    }\n\n    document.getElementById('filterdata').value = JSON.stringify(selectedValues);\n    return true;\n};\n\nconst toggleDropdown = (checkboxId, dropdownId) => {\n    const checkbox = document.getElementById(checkboxId);\n    const dropdown = document.getElementById(dropdownId);\n\n    if (checkbox && dropdown) {\n        dropdown.disabled = !checkbox.checked;\n    }\n};\n\nexport const init = () => {\n    const attachEvent = (selector, event, handler) => {\n        const element = document.getElementById(selector);\n        if (element) {\n            element.addEventListener(event, handler);\n        }\n    };\n\n    attachEvent('submitfilter', 'click', function(e) {\n        if (!readFilter()) {\n            e.preventDefault();\n        }\n    });\n\n    attachEvent('perpage', 'change', function () {\n        if (readFilter()) {\n            this.form.submit();\n        }\n    });\n\n    attachEvent('yearfromcheckbox', 'click', () => toggleDropdown('yearfromcheckbox', 'yearfrom'));\n    attachEvent('yeartocheckbox', 'click', () => toggleDropdown('yeartocheckbox', 'yearto'));\n};\n"],"names":["readFilter","selectedValues","Array","from","document","querySelectorAll","reduce","values","select","id","selectedValue","value","getElementById","checked","yearfrom","yearto","errorDiv","querySelector","errorMsg","createElement","classList","add","then","infomessage","textContent","appendChild","existingError","remove","JSON","stringify","toggleDropdown","checkboxId","dropdownId","checkbox","dropdown","disabled","attachEvent","selector","event","handler","element","addEventListener","e","preventDefault","form","submit"],"mappings":"qKAEMA,WAAa,WACTC,eAAiBC,MAAMC,KAAKC,SAASC,iBAAiB,sBACvDC,QAAO,CAACC,OAAQC,gBACPC,GAAKD,OAAOC,GACZC,cAAgBF,OAAOG,YAGjB,aAAPF,IAA4B,WAAPA,IAAqBL,SAASQ,yBAAkBH,gBAAcI,SAIxFN,OAAOE,IAAMC,cACNH,QAJIA,SAKZ,OAGHN,eAAea,UAAYb,eAAec,QACtCd,eAAea,SAAWb,eAAec,OAAQ,OAC3CC,SAAWZ,SAASQ,eAAe,mBACrCI,WACKA,SAASC,cAAc,eAAgB,OAClCC,SAAWd,SAASe,cAAc,KACxCD,SAASE,UAAUC,IAAI,iCACb,YAAa,iBAAiBC,MAAMC,cAC1CL,SAASM,YAAcD,YACvBP,SAASS,YAAYP,oBAI1B,QAKTF,SAAWZ,SAASQ,eAAe,mBACrCI,SAAU,OACJU,cAAgBV,SAASC,cAAc,eACzCS,eACAA,cAAcC,gBAItBvB,SAASQ,eAAe,cAAcD,MAAQiB,KAAKC,UAAU5B,iBACtD,GAGL6B,eAAiB,CAACC,WAAYC,oBAC1BC,SAAW7B,SAASQ,eAAemB,YACnCG,SAAW9B,SAASQ,eAAeoB,YAErCC,UAAYC,WACZA,SAASC,UAAYF,SAASpB,wBAIlB,WACVuB,YAAc,CAACC,SAAUC,MAAOC,iBAC5BC,QAAUpC,SAASQ,eAAeyB,UACpCG,SACAA,QAAQC,iBAAiBH,MAAOC,UAIxCH,YAAY,eAAgB,SAAS,SAASM,GACrC1C,cACD0C,EAAEC,oBAIVP,YAAY,UAAW,UAAU,WACzBpC,mBACK4C,KAAKC,YAIlBT,YAAY,mBAAoB,SAAS,IAAMN,eAAe,mBAAoB,cAClFM,YAAY,iBAAkB,SAAS,IAAMN,eAAe,iBAAkB"}